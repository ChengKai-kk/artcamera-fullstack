# 架构概览

## 系统上下文（C4 Level 1）

ArtCamera 是一个供终端用户使用的系统，图像生成由外部 AI 服务完成。

```mermaid
C4Context
  title System Context Diagram

  Person(user, "终端用户", "拍摄并获取艺术照片")
  System(artcamera, "ArtCamera", "前端 + 后端系统")
  System_Ext(dashscope, "Alibaba DashScope", "图像生成服务")
  System_Ext(doubao, "Doubao Seedream", "图像生成服务")
  System_Ext(banana, "Banana API", "图像生成服务")

  Rel(user, artcamera, "使用")
  Rel(artcamera, dashscope, "生成图片")
  Rel(artcamera, doubao, "生成图片")
  Rel(artcamera, banana, "生成图片")
```

## 容器架构（C4 Level 2）

系统由浏览器中的前端与 Node.js 后端组成，前端通过 REST 调用后端，后端调用第三方 AI 接口。

```mermaid
C4Container
  title Container Diagram

  Person(user, "终端用户", "触屏交互")
  Container(frontend, "前端 SPA", "Vue 3 + Vite", "自助 UI、拍照流程、任务轮询")
  Container(backend, "后端 API", "Node.js + Express", "任务创建、Provider 统一")
  System_Ext(provider, "AI Provider", "DashScope / Doubao / Banana")

  Rel(user, frontend, "使用")
  Rel(frontend, backend, "HTTP JSON /generate, /tasks/:id")
  Rel(backend, provider, "HTTP Provider API")
```

## 关键组件

- 前端路由：`artcamera_front/src/router/index.js`
- 前端页面：`artcamera_front/src/pages/*.vue`
- 前端 AI 配置：`artcamera_front/src/config/ai.js`
- 后端 API 与 Provider：`artcamera_backend/index.js`

## 数据流概览

1. 用户在前端选择风格
2. 用户拍照，图片与风格存入 sessionStorage
3. 前端调用 POST `/generate` 创建任务
4. 后端转发至指定 Provider
5. 前端轮询 GET `/tasks/:id`
6. 成功后展示结果并生成二维码
